<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToolBox</title>

    <!-- Quill Editor CSS -->
    <link href="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.snow.css" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">

</head>
<body>

<button id="modeToggle" class="btn" onclick="toggleMode()">LIGHT MODE</button>

<h1>Hey Kevin!!!</h1>

<div class="tabs">
    <div id="tabMemo" class="tab active" onclick="switchTab('memo')">Memos</div>
    <div id="tabFinance" class="tab" onclick="switchTab('finance')">Finance</div>
    <div id="tabStocks" class="tab" onclick="switchTab('stocks')">Stocks</div>
    <div id="tabBudget" class="tab" onclick="switchTab('budget')">Budget</div> <!-- NEW -->
</div>

<!-- ---------------- VIEW MODALS ---------------- -->


<div id="memoViewModal" class="modal-overlay">
    <div id="memoViewModalBox" class="modal">
        <h3>Memo Details</h3>
        <div class="view-label">Title</div>
        <div id="viewMemoTitle" class="view-block"></div>

        <div class="view-label">Content</div>
        <div id="viewMemoContent" class="memo-content-view"></div>

        <div class="view-label">Meta</div>
        <div id="viewMemoMeta" class="view-block"></div>

        <div id="viewMemoImageWrapper" style="display:none;">
            <div class="view-label">Media</div>
            <img id="viewMemoImage" style="max-width:100%; border:1px solid var(--border);">
        </div>

        <button class="btn" onclick="closeMemoViewModal()">CLOSE</button>
    </div>
</div>

<!-- ============= FINANCE VIEW MODAL ============= -->
<div id="financeViewModal" class="modal-overlay">
    <div id="financeViewModalBox" class="modal">
        <h3>Account Details</h3>

        <div class="view-label">Bank</div>
        <div id="viewFinanceBank" class="view-block"></div>

        <div class="view-label">Mode</div>
        <div id="viewMode" class="view-block"></div>

        <div class="view-label">Balance (€)</div>
        <div id="viewFinanceBalance" class="view-block"></div>

        <button class="btn" onclick="closeFinanceViewModal()">CLOSE</button>
    </div>
</div>

<!-- ============= FINANCE EDIT MODAL ============= -->
<div id="financeModal" class="modal-overlay">
    <div id="financeModalBox" class="modal">
        <h3>Edit Account</h3>

        <select id="editFinanceBank">
            <option value="N26">N26</option>
            <option value="Sparkasse">Sparkasse</option>
            <option value="Trade Republic">Trade Republic</option>
            <option value="Wise">Wise</option>
            <option value="Revolut">Revolut</option>
        </select>
        <select id="editMode">
            <option value="Current">Current</option>
            <option value="Savings">Savings</option>
            <option value="Broker">Broker</option>
        </select>

        <input id="editFinanceBalance" placeholder="Balance (€)" type="number" step="0.01">

        <button class="btn" onclick="saveFinanceEdit()">SAVE</button>
        <button class="btn" onclick="closeFinanceModal()">CANCEL</button>
    </div>
</div>

<!-- ============= STOCK HOLDING MODAL ============= -->
<div id="stockHoldingModal" class="modal-overlay">
    <div id="stockHoldingModalBox" class="modal">
        <h3 id="stockHoldingModalTitle">Add Holding</h3>

        <input id="stockSymbol" placeholder="Symbol (e.g., AAPL)" maxlength="10">
        <input id="stockQuantity" placeholder="Quantity" type="number" step="0.0000001">
        <input id="stockBuyPrice" placeholder="Buy Price (€)" type="number" step="0.0000001">

        <button class="btn" onclick="saveStockHolding()">SAVE</button>
        <button class="btn" onclick="closeStockHoldingModal()">CANCEL</button>
    </div>
</div>

<!-- ============= WATCHLIST MODAL ============= -->
<div id="watchlistModal" class="modal-overlay">
    <div id="watchlistModalBox" class="modal">
        <h3 id="watchlistModalTitle">Add to Watchlist</h3>

        <input id="watchSymbol" placeholder="Symbol (e.g., TSLA)" maxlength="10">
        <input id="watchInitialPrice" placeholder="Initial Price (€)" type="number" step="0.0000001">

        <button class="btn" onclick="saveWatchlist()">SAVE</button>
        <button class="btn" onclick="closeWatchlistModal()">CANCEL</button>
    </div>
</div>

<!-- ---------------- EDIT MODALS ---------------- -->


<div id="memoModal" class="modal-overlay">
    <div id="memoModalBox" class="modal">
        <h3>Edit Memo</h3>

        <input id="editMemoTitle" placeholder="Title">

        <!-- Quill Editor for Edit -->
        <div id="editMemoContent" style="height: 200px;"></div>

        <select id="editMemoCategory">
            <option value="personal">personal</option>
            <option value="work">work</option>
            <option value="ideas">ideas</option>
            <option value="journal">journal</option>
        </select>

        <label><input type="checkbox" id="editMemoPinned"> Pin?</label>

        <input type="file" id="editMemoFile" accept="image/*">

        <button class="btn" onclick="saveMemoEdit()">SAVE</button>
        <button class="btn" onclick="closeMemoModal()">CANCEL</button>
    </div>
</div>



<!-- ---------------- TAB: MEMOS ---------------- -->

<div id="memoTabContent" class="tab-content">
    <h2>Memos</h2>

    <div class="finance-grid memo-layout" style="display:grid; grid-template-columns:1fr 1fr; gap:16px; align-items:start;">
        <!-- LEFT: ADD MEMO FORM -->
        <div class="add-box" style="position:sticky; top:20px;">
            <h3 style="margin-top:0;">Add Memo</h3>
            <input id="memoTitle" placeholder="Title">

            <!-- Quill Editor -->
            <div id="memoContent" style="height: 150px;"></div>

            <select id="memoCategory">
                <option value="personal">personal</option>
                <option value="work">work</option>
                <option value="ideas">ideas</option>
                <option value="journal">journal</option>
            </select>

            <label><input type="checkbox" id="memoPinned"> Pin?</label>

            <input type="file" id="memoFile" accept="image/*">

            <button class="btn" onclick="addMemo()">ADD MEMO</button>
        </div>

        <!-- RIGHT: MEMO LIST -->
        <div>
            <!-- Pagination Controls -->
            <div id="memoPagination" class="pagination">
                <div class="pagination-info" id="memoPageInfo"></div>
                <div class="pagination-controls">
                    <button class="btn" id="memoFirstBtn" onclick="memoGoToPage(0)">FIRST</button>
                    <button class="btn" id="memoPrevBtn" onclick="memoPrevPage()">PREV</button>
                    <span style="font-size:12px;">Page</span>
                    <input type="number" id="memoPageInput" min="1" value="1" onchange="memoGoToInput()">
                    <span style="font-size:12px;" id="memoTotalPagesSpan"></span>
                    <button class="btn" id="memoNextBtn" onclick="memoNextPage()">NEXT</button>
                    <button class="btn" id="memoLastBtn" onclick="memoGoToLastPage()">LAST</button>
                    <span style="font-size:12px; margin-left:8px;">Show</span>
                    <select id="memoPageSize" onchange="memoChangePageSize()">
                        <option value="10">10</option>
                        <option value="20">20</option>
                        <option value="30">30</option>
                        <option value="40">40</option>
                        <option value="50">50</option>
                    </select>
                </div>
            </div>

            <div id="memoList"></div>
        </div>
    </div>
</div>

<!-- =================== FINANCE TAB =================== -->

<div id="financeTabContent" class="tab-content hidden">
    <h2>Finance Accounts</h2>

    <div class="finance-grid" style="display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:16px;">
        <div class="add-box">
            <h3 style="margin-top:0;">Add Account</h3>
            <select id="financeBank">
                <option value="N26">N26</option>
                <option value="Sparkasse">Sparkasse</option>
                <option value="Trade Republic">Trade Republic</option>
                <option value="Wise">Wise</option>
                <option value="Revolut">Revolut</option>
            </select>

            <select id="mode">
                <option value="Current">Current</option>
                <option value="Savings">Savings</option>
                <option value="Broker">Broker</option>
            </select>

            <input id="financeBalance" placeholder="Balance (€)" type="number" step="0.01">

            <button onclick="addFinance()" class="btn">ADD / UPDATE</button>
        </div>

        <div class="add-box">
            <h3 style="margin-top:0;">Summary</h3>

            <div><b>Total Balance:</b> <span id="sumTotal"></span></div>

            <div style="margin-top:10px;">
                <b>By Mode:</b>
                <ul id="sumByModeList" style="margin:4px 0; padding-left:20px;"></ul>
            </div>

            <div style="margin-top:10px;">
                <b>By Bank:</b>
                <ul id="sumByBankList" style="margin:4px 0; padding-left:20px;"></ul>
            </div>
        </div>
    </div>

    <!-- Pagination Controls -->
    <div id="financePagination" class="pagination">
        <div class="pagination-info" id="financePageInfo"></div>
        <div class="pagination-controls">
            <button class="btn" id="financeFirstBtn" onclick="financeGoToPage(0)">FIRST</button>
            <button class="btn" id="financePrevBtn" onclick="financePrevPage()">PREV</button>
            <span style="font-size:12px;">Page</span>
            <input type="number" id="financePageInput" min="1" value="1" onchange="financeGoToInput()">
            <span style="font-size:12px;" id="financeTotalPagesSpan"></span>
            <button class="btn" id="financeNextBtn" onclick="financeNextPage()">NEXT</button>
            <button class="btn" id="financeLastBtn" onclick="financeGoToLastPage()">LAST</button>
            <span style="font-size:12px; margin-left:8px;">Show</span>
            <select id="financePageSize" onchange="financeChangePageSize()">
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="30">30</option>
                <option value="40">40</option>
                <option value="50">50</option>
            </select>
        </div>
    </div>

    <div id="financeList"></div>

    <br />
    <!-- RETIREMENT GOALS GRID -->
    <div class="finance-grid" style="display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-top:20px;">

        <!-- GOAL SELECTOR & EDITOR -->
        <div class="add-box">
            <h3 style="margin-top:0;">Goal Editor</h3>

            <label style="font-size:11px; opacity:0.7;">Select Goal:</label>
            <select id="goalSelect" onchange="onGoalSelectChange()">
                <option value="">(Select a goal)</option>
            </select>

            <input id="goalTargetIncomeInput" type="number" step="0.01" placeholder="Target net yearly income (€)">
            <input id="goalTaxRateInput" type="number" step="0.001" placeholder="Tax rate (e.g. 0.208)">
            <input id="goalReturnRateInput" type="number" step="0.001" placeholder="Expected return (e.g. 0.065)">
            <input id="goalContributionInput" type="number" step="0.01" placeholder="Yearly contribution (€)">
            <input id="goalAgeInput" type="number" step="1" placeholder="Current age">

            <div style="display:flex; gap:8px; flex-wrap:wrap; margin-top:4px;">
                <button class="btn" onclick="newGoalForm()">NEW</button>
                <button class="btn" onclick="saveGoalForm()">SAVE</button>
                <button class="btn" onclick="deleteGoal()">DELETE</button>
            </div>
            <div id="goalStatus" style="margin-top:6px; font-size:12px; opacity:.7;"></div>
        </div>

        <!-- GOAL SUMMARY + CHART -->
        <div class="add-box">
            <h3 style="margin-top:0;">Retirement Goal</h3>

            <div style="font-size:11px;"><b>Target Yearly Income:</b> <span id="goalTargetIncome"></span></div>
            <div style="font-size:11px;"><b>Required Corpus:</b> <span id="goalRequiredCorpus"></span></div>
            <div style="font-size:11px;"><b>Current Corpus:</b> <span id="goalCurrentCorpus"></span></div>
            <div style="font-size:11px;"><b>Goal Achieved:</b> <span id="goalAchieved"></span></div>
            <div style="font-size:11px;"><b>FIRE Age:</b> <span id="goalFireAge"></span></div>

            <div style="font-size:11px;"><b>Progress:</b> <span id="goalProgress"></span></div>
            <div style="font-size:11px;"><b>Years to Goal:</b> <span id="goalYearsToGoal"></span></div>
            <div style="font-size:11px;"><b>Goal Age:</b> <span id="goalAge"></span></div>
            <div style="font-size:11px;"><b>Remaining Corpus:</b> <span id="goalRemainingCorpus"></span></div>

            <div style="margin-top:10px;">
                <div id="goalProgressBar"
                     style="height:12px; width:100%; background:#222; border:1px solid var(--border);">
                    <div id="goalProgressFill"
                         style="height:100%; width:0%; background:#0f0;"></div>
                </div>
            </div>

            <canvas id="goalChart" width="300" height="120" style="margin-top:10px; width:100%;"></canvas>
        </div>
    </div>

</div>

<!-- =================== STOCKS TAB =================== -->

<div id="stocksTabContent" class="tab-content hidden">
    <h2>Portfolio Tracker</h2>

    <!-- Stats Summary -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-label">Total Invested</div>
            <div class="stat-value" id="statInvested">€0.00</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Current Value</div>
            <div class="stat-value" id="statValue">€0.00</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Total Profit</div>
            <div class="stat-value" id="statProfit">€0.00</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Return %</div>
            <div class="stat-value" id="statReturn">0.00%</div>
        </div>
    </div>

    <!-- Holdings Section -->
    <div class="add-box">
        <h3>Holdings</h3>
        <button class="btn" onclick="showAddHolding()">ADD HOLDING</button>
        <button class="btn" onclick="refreshStocks()">REFRESH</button>
    </div>

    <div id="holdingsList"></div>

    <!-- Watchlist Section -->
    <div class="add-box" style="margin-top:20px;">
        <h3>Watchlist</h3>
        <button class="btn" onclick="showAddWatchlist()">ADD TO WATCHLIST</button>
    </div>

    <div id="watchlistList"></div>
</div>

<!-- =================== BUDGET TAB =================== -->
<div id="budgetTabContent" class="tab-content hidden">
    <h2>Monthly Budget Tracker</h2>

    <!-- Month Selector -->
    <div class="add-box">
        <h3 style="margin-top:0;">Select Month</h3>
        <div style="display:flex; gap:8px; align-items:center;">
            <input type="month" id="budgetMonthPicker" onchange="loadBudgetForSelectedMonth()">
            <button class="btn" onclick="goToCurrentMonth()">CURRENT MONTH</button>
        </div>
    </div>

    <!-- Budget Grid: Planning + Summary -->
    <div class="finance-grid" style="display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:16px;">

        <!-- LEFT: Set Budget Plan -->
        <div class="add-box">
            <h3 style="margin-top:0;">Monthly Plan</h3>

            <h4 style="font-size:12px; margin:10px 0 4px 0;">Expected Income</h4>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:4px; margin-bottom:8px;">
                <input id="planSalary" type="number" step="0.01" placeholder="Salary €">
                <input id="planBonus" type="number" step="0.01" placeholder="Bonus €">
                <input id="planFreelance" type="number" step="0.01" placeholder="Freelance €">
                <input id="planOtherIncome" type="number" step="0.01" placeholder="Other €">
            </div>

            <h4 style="font-size:12px; margin:10px 0 4px 0;">Planned Expenses</h4>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:4px; margin-bottom:8px;">
                <input id="planRent" type="number" step="0.01" placeholder="Rent €">
                <input id="planUtilities" type="number" step="0.01" placeholder="Utilities €">
                <input id="planInternet" type="number" step="0.01" placeholder="Internet €">
                <input id="planTransport" type="number" step="0.01" placeholder="Transport €">
                <input id="planFuel" type="number" step="0.01" placeholder="Fuel €">
                <input id="planGroceries" type="number" step="0.01" placeholder="Groceries €">
                <input id="planDining" type="number" step="0.01" placeholder="Dining Out €">
                <input id="planEntertainment" type="number" step="0.01" placeholder="Entertainment €">
                <input id="planSubscriptions" type="number" step="0.01" placeholder="Subscriptions €">
                <input id="planGym" type="number" step="0.01" placeholder="Gym €">
                <input id="planOtherExpense" type="number" step="0.01" placeholder="Other €">
            </div>

            <button class="btn" onclick="saveBudgetPlan()">SAVE PLAN</button>
        </div>

        <!-- RIGHT: Summary -->
        <div class="add-box">
            <h3 style="margin-top:0;">Summary</h3>

            <div style="font-size:12px; margin-bottom:8px;">
                <div style="display:flex; justify-content:space-between; margin:4px 0;">
                    <span>Planned Income:</span>
                    <span id="summaryPlannedIncome" style="font-weight:bold;">€0.00</span>
                </div>
                <div style="display:flex; justify-content:space-between; margin:4px 0;">
                    <span>Actual Income:</span>
                    <span id="summaryActualIncome" style="font-weight:bold;">€0.00</span>
                </div>
            </div>

            <div style="font-size:12px; margin-bottom:8px; padding-top:8px; border-top:1px solid var(--border);">
                <div style="display:flex; justify-content:space-between; margin:4px 0;">
                    <span>Planned Expenses:</span>
                    <span id="summaryPlannedExpenses" style="font-weight:bold;">€0.00</span>
                </div>
                <div style="display:flex; justify-content:space-between; margin:4px 0;">
                    <span>Actual Expenses:</span>
                    <span id="summaryActualExpenses" style="font-weight:bold;">€0.00</span>
                </div>
            </div>

            <div style="font-size:12px; padding-top:8px; border-top:1px solid var(--border);">
                <div style="display:flex; justify-content:space-between; margin:4px 0;">
                    <span>Savings:</span>
                    <span id="summarySavings" style="font-weight:bold; color:#0f0;">€0.00</span>
                </div>
                <div style="display:flex; justify-content:space-between; margin:4px 0;">
                    <span>Savings Rate:</span>
                    <span id="summarySavingsRate" style="font-weight:bold; color:#0f0;">0%</span>
                </div>
                <div style="display:flex; justify-content:space-between; margin:4px 0;">
                    <span>Budget Adherence:</span>
                    <span id="summaryAdherence" style="font-weight:bold;">100%</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Income/Expense Records -->
    <div class="finance-grid" style="display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:16px;">

        <!-- Add Income -->
        <div class="add-box">
            <h3 style="margin-top:0;">Add Income</h3>
            <select id="incomeCategory">
                <option value="SALARY">Salary</option>
                <option value="BONUS">Bonus</option>
                <option value="FREELANCE">Freelance</option>
                <option value="INVESTMENT">Investment</option>
                <option value="DIVIDEND">Dividend</option>
                <option value="INTEREST">Interest</option>
                <option value="GIFT">Gift</option>
                <option value="OTHER">Other</option>
            </select>
            <input id="incomeAmount" type="number" step="0.01" placeholder="Amount €">
            <input id="incomeDescription" type="text" placeholder="Description">
            <button class="btn" onclick="addIncome()">ADD INCOME</button>
        </div>

        <!-- Add Expense -->
        <div class="add-box">
            <h3 style="margin-top:0;">Add Expense</h3>
            <select id="expenseCategory">
                <option value="RENT">Rent</option>
                <option value="UTILITIES">Utilities</option>
                <option value="INTERNET">Internet</option>
                <option value="TRANSPORT">Transport</option>
                <option value="FUEL">Fuel</option>
                <option value="GROCERIES">Groceries</option>
                <option value="DINING_OUT">Dining Out</option>
                <option value="ENTERTAINMENT">Entertainment</option>
                <option value="SUBSCRIPTIONS">Subscriptions</option>
                <option value="GYM">Gym</option>
                <option value="TRAVEL">Travel</option>
                <option value="CLOTHING">Clothing</option>
                <option value="PERSONAL_CARE">Personal Care</option>
                <option value="EDUCATION">Education</option>
                <option value="GIFTS">Gifts</option>
                <option value="OTHER">Other</option>
            </select>
            <input id="expenseAmount" type="number" step="0.01" placeholder="Amount €">
            <input id="expenseDescription" type="text" placeholder="Description">
            <button class="btn" onclick="addExpense()">ADD EXPENSE</button>
        </div>
    </div>

    <!-- Records Display -->
    <div class="finance-grid" style="display:grid; grid-template-columns:1fr 1fr; gap:16px;">

        <!-- Income Records -->
        <div class="add-box">
            <h3 style="margin-top:0;">Income Records</h3>
            <div id="incomeRecordsList"></div>
        </div>

        <!-- Expense Records -->
        <div class="add-box">
            <h3 style="margin-top:0;">Expense Records</h3>
            <div id="expenseRecordsList"></div>
        </div>
    </div>
</div>

<!-- ---------------- JS ---------------- -->
<!-- Quill Editor JS -->
<script src="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.js"></script>

<script src="app.js"></script>

</body>
</html>